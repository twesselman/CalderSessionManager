{"ts":1362258913960,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var express = require ('express');\r\nvar app = express();\r\n\r\napp.use(express.cookieParser());\r\napp.use(express.cookieSession({ secret: 'Calder Demo Secret', cookie: { maxAge: 60 * 60 * 1000 }}));\r\n \r\nvar ericomurl='http://10.81.108.10:8080/AccessNow/start.html';\r\n\r\napp.configure(function() {\r\n    app.use(express.bodyParser());\r\n    app.use(express.cookieParser());\r\n    app.use(express.session({secret: 'my super secret'}));\r\n    app.use(express.static(__dirname + '/website'));    \r\n    app.use(express.static(__dirname + '/kendo'));\r\n    app.use(express.static(__dirname + '/website/script'));\r\n    app.use(express.static(__dirname + '/website/content'));\r\n    });\r\n\r\n\r\napp.post('/set', function (req, res) {\r\n    console.log('set called');\r\n    req.session.username = req.body.name;\r\n    res.cookie('mycookie', req.body.name);\r\n    res.send('session.username set to ' + req.body.name);\r\n});\r\n\r\napp.get('/read', function(req, res) {\r\n   if(req.session.username)\r\n   {\r\n       var result = 'session.username: ' + req.session.username + '<br>';\r\n       result += 'cookie: ' + req.cookies.mycookie +'<br>';\r\n       \r\n       result += req.cookies;\r\n       res.send(result);\r\n   } \r\n   else\r\n   {\r\n       res.send('no data');\r\n   }  \r\n});\r\n\r\nvar myApps = {\"apps\": [\r\n        {\"name\": \"Outlook\", \"imagefile\": \"outlook.png\", \"exe\": \"/launch/outlook\"},        \r\n        {\"name\": \"Word\", \"imagefile\": \"word.png\", \"exe\": \"/launch/word\"},        \r\n        {\"name\": \"Excel\", \"imagefile\": \"excel.png\", \"exe\": \"/launch/excel\"},        \r\n        {\"name\": \"Powerpoint\", \"imagefile\": \"powerpoint.png\", \"exe\": \"/launch/msppt\"},        \r\n        {\"name\": \"Paint\", \"imagefile\": \"mspaint.png\", \"exe\": \"/launch/mspaint\"},        \r\n        {\"name\": \"Aptana\", \"imagefile\": \"aptana.png\", \"exe\": \"/launch/aptana\"},\r\n        {\"name\": \"Autocad\", \"imagefile\": \"autocad.png\", \"exe\": \"#\"},\r\n        {\"name\": \"SAP ERP\", \"imagefile\": \"erp.png\", \"exe\": \"#\"}\r\n    ]\r\n};\r\n\r\napp.get('/myapps', function(req, res) {\r\n    console.log('get myapps');\r\n    console.log(myApps);\r\n    res.send(JSON.stringify(myApps));\r\n});\r\n\r\napp.post('/login', function(req, res) {\r\n    console.log('login: '+req.body.username + ' password: ' + req.body.password);\r\n    \r\n    // do login stuff\r\n    req.session.login = req.body.username;\r\n    \r\n    res.redirect('/calder.html');\r\n});\r\n\r\napp.get('/launch/:app', function(req, res) {\r\n    console.log('launch called: App: '+req.params.app);\r\n    \r\n    // set cookies (works only if Ericom is on the same server\r\n\r\n    res.cookie('EAN_username', 'Tom');\r\n    res.cookie('EAN_password', 'Cisco123!');\r\n    res.cookie('EAN_autostart', 'true');\r\n    res.cookie('EAN_remoteapplicationmode', 'true');\r\n\r\n    var appPath;\r\n    switch (req.params.app) {\r\n    case 'aptana': \r\n        appPath = '\"C:\\\\Users\\\\Administrator\\\\AppData\\\\Local\\\\Aptana Studio 3\\\\AptanaStudio3.exe\"';\r\n        break;\r\n    case 'desktop': \r\n        res.cookie('EAN_remoteapplicationmode', 'false');\r\n        console.log('Launching: desktop');\r\n        break;\r\n    default: \r\n        appPath = req.params.app;\r\n    \r\n    }\r\n\r\n    if (appPath) {\r\n        res.cookie('EAN_alternate_shell', appPath);\r\n        console.log('Launching: ' + appPath);\r\n    } \r\n    \r\n    var url = ericomurl;\r\n    if (appPath) {\r\n        url += '?autostart=true&remoteapplicationmode=true&username=Tom&password=Cisco123!&alternate_shell=';\r\n        url += appPath;        \r\n    }    \r\n    else {\r\n        url += '?autostart=true&username=Tom&password=Cisco123!';\r\n    }\r\n    \r\n    console.log(url);\r\n    res.redirect(url);\r\n\r\n//    res.redirect(ericomurl);\r\n});\r\n\r\n\r\n// listen\r\nvar port = process.env.PORT || 80;\r\napp.listen(port, function () {\r\n    console.log('Calder Demo - listening on '+port);\r\n});\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":3740}]],"length":3740}
